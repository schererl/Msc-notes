# MSc Notes
Notes and remarks for my research in heuristic search for HTN planning.

---

## Master's TODO

- [ ] **Mark** the presentation as "ongoing work"
- [ ] **Enroll** in the master's last semester
- [ ] **Get** the LaTeX format for the Dissertation

---

## Summary

This document summarizes the current research tasks and experiments related to:

1. [Novelty heuristic](#novelty-heuristic)  
2. [Work on landmarks](#work-on-landmarks)  
3. [Usage of bidirectional landmarks in a state-of-the-art planner (PANDA)](#usage-of-bidirectional-landmarks-in-state-of-the-art-panda)  
4. [Organizational tasks](#organization)

---

# Novelty Heuristic

- [x] **Read** the paper [A Novelty-based Heuristic for Problem Solving](https://ojs.aaai.org/index.php/AAAI/article/view/11027).
- [x] **Implement** novelty in Pytrich using `<(h,t,f), h>`.
- [ ] **Compare** novelty with the original heuristic `h`.
- [ ] **Implement** the novelty approach in **PANDA**.

**Expectations**  
Find out if novelty can:
- Contribute to solving more problems in general, or  
- At least provide an advantage in specific domains.

### Definition (Novelty in HTN planning):

Let **F** be a set of facts and **T** a set of tasks of a given HTN plannning problem $\Pi$.  
Let $ h_1, h_2, \dots, h_m $ be heuristic functions  
and $n = (s,TN)$ be a newly generated node with state $s$ and the task network $ TN $.

We defined the set of nodes generated before $n$:
$$
N(n) = \{ n' \mid n' \text{ was generated before } n \text{ and } h_j(s') = h_j(s) \text{ for all } 1 \le j \le m \}.
$$

A novelty element of node $n$ is $w = (h, f, t)$


where:
- $ h $ is the tuple of heuristic values of $n$ ($h_1, \dots, h_m$),
- $ f $ is a fact such that $ f \in s $, and
- $ t $ is the selected task from the task network (i.e. $index(t, TN) = 0$).

Let $W_n$ be the set of novelty elements generated by node $n$.  
A node $n$ is **novel** if there exists a novelty element $w \in W_n$ 
such that for every node $n' \in N(n)$ it holds that $w \notin W_{n'}$.


### February - Novelty Experiments

Implemented different novelty methods considering different heuristic values.

- The novelty elements are $w = (h, f, t)$.

- We use Greedy Best-First Search (GBFS) with the queue ordered as $(w, h')$, where $h \subseteq h'$.  
- To validate whether novelty helps solve more tasks, we typically compare configurations denoted as $(w, h)$ versus $(h)$.
1. **lmcount:**  
   - **Heuristic:** Uses the landmark count computed from bottom-up landmarks, denoted as $h_{lm}(n)$.  
   - **Evaluation Function:** $f(n) = h_{lm}(n)$.  
   - **Remarks:** Serves as a baseline to assess the effect of adding a novelty component.

2. **TDG-satis:**  
   - **Heuristic:** Uses the Task Decomposition Graph (TDG) heuristic with a satisficing approach, denoted as $h_{TDG}(n)$.  
   - **Evaluation Function:** $f(n) = h_{TDG}(n)$.  
   - **Remarks:** Provides another baseline for comparison, focusing solely on TDG-satis.

3. **lmcount-tdg:**  
   - **Heuristic:** Combines the landmark count and TDG-satis, i.e., $h(n) = (h_{lm}(n), h_{TDG}(n))$, without incorporating novelty.  
   - **Evaluation Function:** $f(n)$ is derived from the lexicographic ordering of $h_{lm}(n)$ and $h_{TDG}(n)$, i.e., $f(n) = (h_{lm}(n), h_{TDG}(n))$.  
   - **Remarks:** Provides a baseline to isolate the impact of novelty when added to the combined heuristic.

4. **Novelty-lm-f-t:**  
   - **Heuristic Component ($h$):** $h_{lm}(n)$ from the landmark count.  
   - **Novelty Computation:** Computes the novelty element as  
     $$w(n) = (h_{lm}(n), f, t),$$  
     where $f \in s$ and $t$ is the selected task (i.e., $index(t, TN) = 0$).  
   - **Evaluation Function:** $f(n) = (w(n), h_{lm}(n))$, meaning the node is evaluated first by its novelty and then by the landmark count.  
   - **Remarks:** Assesses if adding novelty improves performance over the baseline using only the landmark count.

5. **Novelty-lm-tdg-f-t:**  
   - **Heuristic Component ($h$):** A composite heuristic defined as $h(n) = (h_{lm}(n), h_{TDG}(n))$, combining both landmark count and TDG-satis.  
   - **Novelty Computation:** Computes the novelty element as  
     $$w(n) = (h(n), f, t).$$  
   - **Evaluation Function:** $f(n) = (w(n), h(n))$, where nodes are primarily ranked by their novelty measure and secondarily by the composite heuristic.  
   - **Remarks:** Evaluates if integrating novelty into a combined heuristic (landmark count and TDG-satis) improves planning performance over the combined baseline.

6. **Novelty-tdg-f-t:**  
   - **Heuristic Component ($h$):** Uses the TDG-satis heuristic, denoted as $h_{TDG}(n)$.  
   - **Novelty Computation:** Computes the novelty element as  
     $$w(n) = (h_{TDG}(n), f, t).$$  
   - **Evaluation Function:** $f(n) = (w(n), h_{TDG}(n))$.  
   - **Remarks:** Determines the effect of incorporating novelty on the TDG-satis heuristic performance.

7. **Novelty-bid-tdg-f-t:**  
   - **Heuristic Component ($h$):** Integrates bidirectional landmarks with TDG-satis, denoted as $h_{bidTDG}(n)$.  
   - **Novelty Computation:** Computes the novelty element as  
     $$w(n) = (h_{bidTDG}(n), f, t).$$  
   - **Evaluation Function:** $f(n) = (w(n), h_{bidTDG}(n))$.  
   - **Remarks:** Assesses whether including bidirectional landmarks within the novelty framework further improves planner performance.

8. **Novelty-tdg-bid-f-t:**  
   - **Heuristic Component ($h$):** Uses TDG-satis and bidirectional landmarks in an alternative ordering, denoted as $h_{TDGbid}(n)$.  
   - **Novelty Computation:** Computes the novelty element as  
     $$w(n) = (h_{TDGbid}(n), f, t).$$  
   - **Evaluation Function:** $f(n) = (w(n), h_{TDGbid}(n))$.  
   - **Remarks:** Compares the impact of different orderings of the heuristic components on the novelty measure and overall search behavior.

9. **Novelty-lmonly_bu-tdg-f-t:**  
   - **Heuristic Component ($h$):** Primarily based on the landmark count from a bottom-up approach, i.e., $h_{lm}(n)$.  
   - **Tie-breaking:** Utilizes TDG-satis, denoted as $h_{TDG}(n)$, as a secondary criterion to break ties.  
   - **Novelty Computation:** Computes the novelty element as  
     $$w(n) = (h_{lm}(n), f, t),$$  
     with the TDG-satis value influencing the evaluation only when novelty measures are equal.  
   - **Evaluation Function:** $f(n) = (w(n), h_{lm}(n))$, where $h_{TDG}(n)$ acts as the tie-breaker.  
   - **Remarks:** Investigates if reducing the number of potential novelty tuples by using a single primary heuristic (landmark count) with TDG-satis as tie-breaker yields better planning outcomes.

**Data Files:**
- [csv file1 here](Pytrich/Experiments/outputs/csv-files/novelty/novelty-experiments.csv)
- [csv file2 here](PytrichExperiments/outputs/csv-files/novelty/novelty-experiments-stats.csv)



---

# Work on Landmarks

## Experiments on Mandatory Tasks

Isolate the set of mandatory tasks found by the bottom-up approach and see differences in performance of:
- MT
- BU
- IBU (isolated bottom-up)

## Experiments on Landmark Updates

Test if landmark updates can be effective, running an extended version in PANDA.

**Expectations**  
Landmark updates are a fast way to generate more landmarks without the need for recomputing them entirely (which is expensive), thus this approach could add information without compromising the heuristicâ€™s role.

---

## Usage of Bidirectional Landmarks in State-of-the-Art PANDA-LAMA

- [x] **Implement** bidirectional landmarks in **PANDA-lama**.
- [ ] **Run** experiments comparing bidirectional landmarks with LM-Cut and bottom-up approaches.

**Expectations**  
Determine if bidirectional landmarks enhance the performance of state-of-the-art planners.

---

# Organization

## Merge the PANDA Projects

- [ ] Merge **panda-lama** and **Dealer** into a single GitHub repository.
- [ ] Organize files and scripts in a coherent structure.
- [ ] Standardize the parser and grounder so they can work in both.

---
